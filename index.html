<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verifina.pro - Scam Detector</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-image: url('https://images.unsplash.com/photo-1521737604893-d14cc237f11d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');
      background-size: cover;
      font-family: 'Georgia', serif;
    }
    .glass {
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(12px);
    }
    .spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top: 3px solid #ffd700;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="text-white min-h-screen flex items-center justify-center p-4">
  <div class="glass p-8 rounded-xl shadow-2xl max-w-2xl w-full">
    <h1 class="text-4xl font-bold text-yellow-300 mb-4 text-center">üîç Verifina.pro</h1>
    <p class="text-lg mb-6 text-center">Check if any website is a scam</p>

    <form id="checkForm" class="mb-6">
      <input 
        type="text" 
        id="urlInput" 
        placeholder="example.com" 
        class="w-full p-3 rounded mb-4 bg-black bg-opacity-50 border border-yellow-400"
        required
      >
      <button 
        type="submit" 
        id="checkBtn" 
        class="bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-3 px-6 rounded-lg w-full flex items-center justify-center"
      >
        <span id="spinner" class="spinner hidden mr-2"></span>
        <span id="btnText">Check Website</span>
      </button>
    </form>

    <div id="resultContainer" class="hidden">
      <div id="freeResult" class="hidden">
        <h2 class="text-xl font-bold mb-2">Scam Analysis</h2>
        <div id="reportContent" class="bg-black bg-opacity-50 p-4 rounded-lg mb-4 whitespace-pre-line"></div>
        <p id="usageCounter" class="text-sm text-yellow-300"></p>
      </div>
      
      <div id="lockedResult" class="hidden bg-red-900 bg-opacity-50 p-4 rounded-lg">
        <p class="font-bold mb-2">üîí Free Check Used</p>
        <p class="mb-4">Unlock unlimited checks for just $2</p>
        <a href="https://akiagi3.gumroad.com/l/bhphh" target="_blank" class="block">
          <button class="bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-2 px-4 rounded w-full">
            Unlock Now
          </button>
        </a>
      </div>
    </div>
  </div>

<script>
document.getElementById('checkForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const url = document.getElementById('urlInput').value.trim();
    if (!url) return alert('Enter a website URL');
    
    // UI states
    const btn = document.getElementById('checkBtn');
    btn.disabled = true;
    document.getElementById('spinner').classList.remove('hidden');
    document.getElementById('btnText').textContent = 'Analyzing...';
    
    try {
        const response = await fetch('/api/check', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            credentials: 'include',
            body: JSON.stringify({ domain: url })
        });
        
        const data = await response.json();
        console.log("API Response:", data);
        
        if (data.error) {
            alert(`Error: ${data.error}`);
            return;
        }
        
        document.getElementById('resultContainer').classList.remove('hidden');
        
        if (data.status === 'locked') {
            document.getElementById('freeResult').classList.add('hidden');
            document.getElementById('lockedResult').classList.remove('hidden');
        } else {
            document.getElementById('freeResult').classList.remove('hidden');
            document.getElementById('lockedResult').classList.add('hidden');
            
            document.getElementById('reportContent').textContent = `
Risk Score: ${data.risk_score}% - ${data.risk_level}

${data.full_report}
            `;
            
            document.getElementById('usageCounter').textContent = 
                data.status === 'unlocked' 
                    ? "‚úÖ Premium - Unlimited scans" 
                    : "‚ö†Ô∏è Free check used (1/1)";
        }
    } catch (error) {
        alert("Failed to check website. Try again.");
        console.error(error);
    } finally {
        btn.disabled = false;
        document.getElementById('spinner').classList.add('hidden');
        document.getElementById('btnText').textContent = 'Check Website';
    }
});
</script>
  <div class="mt-8 text-center text-sm text-yellow-200">
    <p>‚ö†Ô∏è Verifina can make mistakes. Always double-check manually.</p>
    <p>üì© Contact: <a href="mailto:Verifina.pro@gmail.com" class="underline hover:text-yellow-300">Verifina.pro@gmail.com</a></p>
  </div>
</body>
</html>
